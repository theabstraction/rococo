(' #file.type rococo)

(' #include 
	"!scripts/types.sxy"
	"!scripts/mplat_sxh.sxy"
	"!scripts/mplat_types.sxy"
)

(namespace EntryPoint)
	(alias Main EntryPoint.Main)
	
(using Rococo)
(using Rococo.Graphics)
(using Rococo.Entities)
(using Sys.Type)
(using Sys.Maths)

(struct GlobalState
	(IString squirrelName)
	(IString catName)
	(IString dogName)
	(Float64 age)
	(Vec3 position)
	(Matrix4x4 world)
	(Bool isActive)
)

(function Main (Int32 id)->(Int32 exitCode):
	(IInstances instances (Instances))
	(instances.SetMaterialMacro "!textures/hv/materials/hi-rez/" )
	(instances.LoadMaterialArray "#m/" 1024)
	
	(IHQFonts fonts (HQFonts))
	(fonts.Build (#HQFontEditorFont))
	(fonts.SetFaceName "Courier New")
	(fonts.MakeBold)
	(fonts.AddRange 32 127)
	(fonts.AddCharacters "£")
	(fonts.SetHeight 24)
	(fonts.Commit)

	(fonts.Build (#HQFontTitleFont))
	(fonts.SetFaceName "Tahoma")
	//(fonts.MakeBold)
	(fonts.AddRange 32 127)
	(fonts.SetHeight 80)
	(fonts.Commit)
	
	(fonts.Build (#HQFontDebuggerFont))
	(fonts.SetFaceName "Consolas")
	//(fonts.MakeBold)
	(fonts.AddRange 32 127)
	(fonts.AddCharacters "£")
	(fonts.SetHeight 28)
	(fonts.Commit)

	(fonts.Build (#HQFontInfoFont))
	(fonts.SetFaceName "Times New Roman")
	(fonts.AddRange 32 127)
	(fonts.AddCharacters "£")
	(fonts.SetHeight 28)
	(fonts.Commit)

	(Sys.Reflection.SexyAssetFile assetFile = "!scripts/test/asset.sxya")
	
	(IString dogName = NullString)
	(IStringBuilder squirrelName = (NewParagraphBuilder))
	(#build squirrelName "Geoff")
	
	(GlobalState globalState = 
		squirrelName
		"Meow-meow"
		dogName
		17.6 // age
		(1.4 2.5 7.6) // position
		( // world
			(1 0 0 0)
			(0 1 0 0)
			(0 0 1 0)
			(0 0 0 1)
		)
		false
	)
	
	// save the global state to !scripts/test/asset.sxya
	(reflect SaveAsset assetFile globalState)

	// restor the global state from !scripts/test/asset.sxya
	(GlobalState copiedStateState)
	(reflect LoadAsset assetFile copiedStateState)
	
	(debug)
)